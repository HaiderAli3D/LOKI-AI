files:
  "/opt/elasticbeanstalk/hooks/appdeploy/pre/01_get_credentials.sh":
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/bin/bash
      # Create directory if it doesn't exist
      mkdir -p /var/app/current/credentials
      
      # Download service account key from S3
      aws s3 cp s3://ai-tutor-credentials/firebase-service-account.json /var/app/current/credentials/firebase-service-account.json
      
      # Set proper permissions
      chmod 600 /var/app/current/credentials/firebase-service-account.json
      chown webapp:webapp /var/app/current/credentials/firebase-service-account.json

option_settings:
  aws:elasticbeanstalk:application:environment:
    FIREBASE_SERVICE_ACCOUNT_PATH: "/var/app/current/credentials/firebase-service-account.json"
